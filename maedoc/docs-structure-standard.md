# docs/ 目录结构标准

> **权威来源**：本文件是 MaeDoc `docs/` 目录结构的唯一标准定义。
> 所有命令（Commands）、Skill 和 Agent 行为均须遵守本标准。
> 本标准由 `AGENTS.md §3.5` 引用，自动作用于所有写作流程。

---

## 1. 目录布局

```
docs/
├── index.md              # 全库入口（导航枢纽，必须存在且保持最新）
├── {topic}/              # 多文档集合目录（主题超 300 行时使用）
│   ├── index.md          # 局部导航入口（该集合的导航枢纽）
│   └── {sub-doc}.md      # 子文档
├── {single-doc}.md       # 独立单文档（主题在 300 行以内时使用）
├── _archive/             # 归档目录（已停用但保留的文档）
└── TODO.md               # 代办事项（由 todo-append Skill 维护）
```

**约束**：

- `docs/index.md` 是全库唯一顶层入口，**必须存在**且保持最新
- 每个多文档集合目录**必须有** `index.md` 作为局部导航
- 所有新文档创建后必须在 `docs/index.md` 的文档地图中注册
- 归档文档移入 `docs/_archive/`，不直接删除

---

## 2. index.md 规范

### 2.1 职责定义

`index.md`（无论是全库入口还是局部入口）都是**纯导航文档**：

- **职责**：帮助读者快速找到所需内容，提供文档目录和简要摘要
- **不承担**：实质性内容章节（具体内容由子文档承载）
- **行数目标**：60–120 行（全库 index.md 可适当放宽至 150 行）

### 2.2 必须包含的章节

| 章节 | 说明 |
|------|------|
| 文档地图 | 表格形式列出所有子文档，含相对路径链接和一句话描述 |
| 内容导览 | 每个子文档的 2-3 句摘要，帮助读者选择 |

### 2.3 文档地图格式

```markdown
## 文档地图

| 文档 | 说明 | 预估阅读时间 |
|------|------|------------|
| [子文档标题](./relative/path.md) | 一句话描述核心内容 | ~N 分钟 |
```

### 2.4 全库 docs/index.md 额外要求

全库入口还应包含：

- `## 概述`：整体简介（2-4 句话，说明文档库的目的和覆盖范围）
- `## 项目文档关系`（可选）：说明 docs/ 与其他文档（README、AGENTS.md 等）的关系

---

## 3. 行数限制

**每个 Markdown 文件（包括 index.md）行数不超过 300 行**。

| 场景 | 处理规则 |
|------|---------|
| 预估 ≤ 300 行 | 单文件创建 |
| 预估 > 300 行 | 拆分为多文档集合（目录 + index.md + 子文档） |
| 实际超出 300 行 | 使用 `/evolve` 拆分，或记录 TODO |
| 允许弹性 | ±10%（即 330 行以内可视为合格） |

**由谁执行**：

- `doc-outline-generate` Skill 在规模评估阶段自动判断单文件 vs 多文件
- `/create` 命令按 Skill 输出决定创建形式
- `/evolve` 命令在全库扫描时检测并修复超长文档
- `doc-evaluate` Skill 报告违规文档

---

## 4. 文件命名规则

| 规则 | 说明 |
|------|------|
| 格式 | `kebab-case` 英文小写（如 `cap-theorem-notes.md`） |
| 入口文档 | 统一命名为 `index.md` |
| 无法提取关键词 | 使用 `doc-{YYYYMMDD}.md` |
| 重名时 | 追加序号后缀，如 `cap-theorem-2.md` |
| 归档文档 | 保持原名，移入 `_archive/` |

---

## 5. 交叉引用规则

- **统一使用相对路径**：`[标题](./subdir/file.md)` 或 `[标题](../other/file.md)`
- **禁止绝对路径**（如 `/docs/file.md`）
- **链接文字**与目标文档 H1 标题保持一致（可简化，但语义不变）
- **子文档间引用**：优先通过 index.md 引用，子文档间直接交叉引用应保持最小化

---

## 6. 多文档集合结构

当主题预估超过 300 行时，以多文档集合形式组织：

```
docs/{topic}/
├── index.md              # 导航入口（目标 60-80 行，≤ 150 行）
├── {aspect-1}.md         # 子文档1（目标 150-250 行，≤ 300 行）
├── {aspect-2}.md         # 子文档2（目标 150-250 行，≤ 300 行）
└── {aspect-N}.md         # 子文档N（目标 150-250 行，≤ 300 行）
```

**子文档一致性原则**：

1. **术语统一**：同一概念在各子文档中使用相同表述
2. **不重复**：子文档间不复制内容；交叉内容通过链接引用
3. **可独立阅读**：每个子文档开头提供必要背景，无需阅读其他子文档也能理解

---

## 7. 违规检测与修复

以下场景视为违规：

| 违规类型 | 检测方式 | 修复方式 |
|---------|---------|---------|
| 文档超过 300 行（含弹性） | `/evolve` 扫描 / `doc-evaluate` | 使用 `/evolve` 拆分 |
| 子文档未在 `docs/index.md` 中注册 | `/evolve` 扫描（未收录文档列表） | `/create` 自动注册 / 手动补充 |
| index.md 包含大量实质内容 | 人工判断 / `doc-evaluate` | 将实质内容迁移到子文档 |
| 使用绝对路径引用 | `doc-evaluate`（断链检测） | 替换为相对路径 |
| 子目录缺少 index.md | `/evolve` 扫描 | 创建导航入口 |
| 新建子目录未登记到上层 index.md | `/create` 检查 / `/evolve` 扫描 | 补充文档地图条目 |

---

## 引用本标准

各命令和 Skill 在涉及 docs/ 结构操作时，应添加以下引用：

> **docs 结构标准**：遵循 `maedoc/docs-structure-standard.md` 的定义。
