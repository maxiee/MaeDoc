// opencode.jsonc — MaeDoc Open Code 基础配置
// 策略：本地优先 + 权限收紧，保障隐私安全
{
  // 禁用会话分享，确保文档内容不外泄
  "share": "disabled",
  // 注：OpenCode 顶层字段为 "plugin"（数组），不是 "plugins"。
  // 本地 .opencode/plugins/ 下插件可直接随项目分发；如需 npm 插件再配置 "plugin": ["pkg-name"]。
  // 权限策略：所有敏感操作均需用户确认
  "permission": {
    "edit": "allow", // 允许编辑（由命令层控制确认策略）
    "bash": "allow", // 允许执行命令（由命令层控制确认策略）
    "webfetch": "allow", // 允许网络请求（敏感外发仍需脱敏检查）
    "external_directory": "allow", // 允许外部目录访问（命令内需说明原因）
    "doom_loop": "allow", // 允许循环保护机制继续执行
    "plugin": {
      "*": "ask",
      "maedoc-guardian": "allow"
    }
  },
  // 上下文压缩策略：自动压缩，保留关键上下文
  "compaction": {
    "auto": true, // 接近上下文窗口限制时自动压缩
    "prune": true // 裁剪低价值历史消息
    // "reserved": 10000 // 为新内容预留 10000 token
  },
  // 写作指南：引用通用写作规范作为 AI 基线约束
  // 注意：writing-guidelines.md 将在 v0006 中生成
  "instructions": [
    "maedoc/writing-guidelines.md"
  ]
}
