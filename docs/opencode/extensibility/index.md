# OpenCode 扩展能力

> **所属系列**：[OpenCode 使用指南](../index.md)
> **最后更新**：2026-02-22

---

## 概述

OpenCode 是一个开源 AI 编码代理，面向终端（TUI）、桌面应用与 IDE 扩展等多种入口形态。它的"可扩展性主干"可以拆成六条能力面：

```
┌─────────────────────────────────────────────────────────────┐
│                    OpenCode 可扩展性主干                      │
├─────────────────────────────────────────────────────────────┤
│  Plugins         │ 事件总线挂钩，改写 LLM/工具调用行为          │
│  Custom Tools     │ TypeScript/JS 函数，LLM 可调用             │
│  MCP Servers      │ 外部工具集，本地/远程接入                   │
│  Agents/Rules     │ 可组合工作流，提示词/权限/工具定义          │
│  Server/SDK       │ OpenAPI 3.1 + SSE，可编程代理后端          │
│  安全边界         │ 权限、CORS、工作区信任、审计日志             │
└─────────────────────────────────────────────────────────────┘
```

---

## 文档地图

### 六大扩展能力

| 文档 | 说明 | 风险等级 |
|------|------|:--------:|
| [Plugins 扩展机制](./plugins.md) | 事件总线 Hook、before/after 改写行为 | 🔴 高 |
| [Custom Tools](./custom-tools.md) | TypeScript/JS 定义 LLM 可调用函数 | 🔴 高 |
| [MCP Servers](./mcp-servers.md) | 接入外部工具集（本地/远程） | 🟡 中 |
| [Agents/Rules/Skills](./agents-rules-skills.md) | 可组合工作流定义体系 | 🟢 低 |
| [Server/SDK](./server-sdk.md) | OpenAPI 3.1 + SSE 远程集成 | 🔴 高 |
| [安全边界](./security-boundary.md) | 权限控制、审计、应急响应 | — |

### 学习路径

| 文档 | 说明 |
|------|------|
| [扩展开发学习路径](./learning-path.md) | 从入门到精通的完整路线图 |

---

## 能力选择指南

### 按场景选择

| 场景 | 推荐能力 | 原因 |
|------|---------|------|
| 在 LLM 调用前后注入上下文 | **Plugins** | 事件钩子机制最直接 |
| 执行复杂逻辑/调用 API | **Custom Tools** | 代码级控制 |
| 接入企业内部工具 | **MCP Servers** | 跨语言、可远程 |
| 定义 AI 行为模式 | **Skills** | 纯文本，易维护 |
| 集成到自有应用 | **Server/SDK** | 标准化接口 |
| 多能力组合工作流 | **Agents + Rules** | 声明式配置 |

### 按风险等级选择

| 风险偏好 | 推荐能力 | 避免 |
|---------|---------|------|
| 保守 | Skills, Agents | Plugins, Tools, 公网 Server |
| 平衡 | Skills + MCP（受限） | 直接暴露 Server |
| 激进 | 全部能力 | 无（但必须启用审计） |

---

## 架构图

```
                    ┌─────────────────────────────────────┐
                    │           用户入口                   │
                    │  TUI / 桌面端 / IDE 扩展 / SDK 客户端  │
                    └──────────────┬──────────────────────┘
                                   │
                                   ▼
┌────────────────────────────────────────────────────────────────┐
│                        OpenCode Runtime                         │
├────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐ │
│  │   Plugins   │  │    Tools    │  │      MCP Servers        │ │
│  │  (Hook 机制) │  │ (TS/JS 函数)│  │   (外部工具协议)          │ │
│  └──────┬──────┘  └──────┬──────┘  └───────────┬─────────────┘ │
│         │                │                     │               │
│         └────────────────┼─────────────────────┘               │
│                          │                                     │
│                          ▼                                     │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    统一工具调度层                           │ │
│  └───────────────────────────┬───────────────────────────────┘ │
│                              │                                 │
│  ┌───────────────────────────┼───────────────────────────────┐ │
│  │                           │                               │ │
│  │  ┌────────────┐  ┌────────┴────────┐  ┌────────────────┐  │ │
│  │  │   Agents   │  │     Rules       │  │     Skills     │  │ │
│  │  │  (代理)    │  │    (规则)       │  │    (能力)      │  │ │
│  │  └────────────┘  └─────────────────┘  └────────────────┘  │ │
│  │                                                           │ │
│  │              可组合工作流定义体系                            │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
└────────────────────────────────┬────────────────────────────────┘
                                 │
                                 ▼
                    ┌────────────────────────┐
                    │      安全边界检查       │
                    │  • 权限验证            │
                    │  • 审计日志            │
                    │  • 沙箱隔离            │
                    └────────────┬───────────┘
                                 │
                                 ▼
                    ┌────────────────────────┐
                    │      AI Models         │
                    │  (Claude / GPT / ...)  │
                    └────────────────────────┘
```



## 相关文档

- [OpenCode 使用指南](../index.md) — 安装、配置、基础使用
- [Skills 使用入门](../skills-basics.md) — Skills 基础概念
- [SKILL.md 开发规范](../skill-md-spec.md) — Skill 文件规范

---

*本导航由 `/evolve` 命令生成，基于 OpenCode 六支柱扩展架构，最后更新：2026-02-22*
