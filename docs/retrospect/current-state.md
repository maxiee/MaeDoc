# 项目现状：我们走到了哪里

> **本文档定位**：回顾 MaeDoc Phase 0-7 的关键产出，勾勒项目骨架
> **所属分组**：[回顾与反思](./index.md)
> **相关文档**：[核心设计反思](./design-reflections/index.md)

---

## 1. 引言：为什么要回顾

在思考未来之前，我需要先搞清楚一个基础问题：**我们究竟建成了什么？**

dev_plan.md 是任务清单，记录了「做了什么」。但这份文档想回答的是「为什么这么做」以及「做得怎么样」。这两者不一样。

这个回顾不求面面俱到，而是要抓住几个关键节点，理解设计背后的逻辑。

---

## 2. Phase 0：基础设施的奠基

### 2.1 AGENTS.md：智能体规则的定位

**做了什么**：定义了 MaeDoc AI Agent 的行为准则、写作原则、安全红线。

**设计决策**：
- 把 AI 行为规则放在根目录的 `AGENTS.md`，而不是分散在各个 skill 里
- 这样做的好处是：用户打开仓库第一眼就能看到 AI 的「宪法」
- 代价是：AGENTS.md 需要承载过多职责，文件越来越长

**现在的看法**：
- 这个决策是对的，但 AGENTS.md 的组织结构需要优化
- §8「主动求助规则」的引入，说明 AI 的能力边界问题越来越重要
- 未来可能需要把「写作规范」抽离到单独文件，AGENTS.md 只保留核心行为规则

### 2.2 opencode.jsonc：权限收紧的基线

**做了什么**：配置了保守的权限策略（edit=ask, bash=ask, ...）。

**设计决策**：
- 「本地优先」意味着宁可多问，也不要擅自操作
- 禁用会话分享（share=disabled），保护隐私

**现在的看法**：
- 这个策略在实际使用中比较烦，每次操作都要确认
- 但考虑到 AI 可能产生意外行为，保守是对的
- 可能需要引入「信任模式」：用户可以显式放宽权限

---

## 3. Phase 1-2：从类型系统到能力驱动

### 3.1 文档类型系统（已删除）

**做了什么**：定义了 `doc-type.schema.v1.json`，创建了 tech-design、blog-post、generic 三种内置类型。

**为什么删除（v0022）**：
- 模板系统限制了 AI 的自由度
- 用户（我）发现自己在「填模板」而不是「自由写作」
- 模板的章节定义往往不符合实际需求

**现在的看法**：
- 删除是对的，但删除之后留下了「AI 如何判断结构」的问题
- 这个问题到现在也没有完美解决
- 可能需要「半结构化」的中间形态：给 AI 一些可选的结构参考，但不强制

### 3.2 Skills 架构：8 个能力

**做了什么**：创建了 8 个 AI Skills，每个负责一个写作环节。

| Skill | 职责 |
|-------|------|
| `doc-outline-generate` | 根据想法生成大纲 |
| `doc-content-fill` | 根据大纲填充内容 |
| `doc-review` | 多维度审阅文档 |
| `doc-format-normalize` | 格式规范化 |
| `doc-structure-audit` | 结构合规检查 |
| `doc-quality-score` | 质量评分 |
| `doc-iterate` | 基于反馈迭代 |
| `doc-translate` | 多语言翻译 |

> **编者注（2026-02-22）**：`doc-review`、`doc-quality-score`、`doc-structure-audit` 三个 Skill 已在 v0008 重构中合并为 `doc-evaluate`（7 维度统一评估）。上表反映的是 Phase 1-2 时期的历史状态。

**设计决策**：
- 按「功能」拆分，而非按「文档类型」拆分
- 每个 Skill 专注一件事，理论上可组合

**现在的看法**：
- 这个拆分粒度是否合适？有时候为了写一个文档要调用 4-5 个 skill
- Skill 之间的协作关系不够清晰
- 用户（我）很难记住每个 Skill 做什么，通常通过 `/create` 命令间接使用
- 可能需要重新审视 Skill 的划分逻辑

---

## 4. Phase 3-4：命令层与自由化演进

### 4.1 /create 命令：用户的主入口

**做了什么**：将多个 Skill 组装成一个端到端的写作流程。

```
/create [想法描述] → 大纲生成 → 确认 → 内容填充 → 格式化 → 输出
```

**设计决策**：
- 用户不需要知道 Skill 的存在，只需要一个命令
- 交互式确认大纲，确保方向正确

**现在的看法**：
- 这是对的设计，降低了使用门槛
- 但交互步骤比较多（question 工具的使用），有时候想「直接给我结果」
- v2.0.0 引入了「阶段 0.5：深化需求探询」，进一步增加了交互

### 4.2 v0022：删除模板，拥抱自由

**做了什么**：删除了所有文档类型模板，让 AI 根据内容自主判断结构。

**设计决策**：
- 模板是束缚，不是助力
- AI 应该有能力判断「这篇内容适合什么结构」

**现在的看法**：
- 自由化的代价是：AI 有时候生成的结构不尽人意
- 用户需要多次「修改大纲」才能得到想要的结构
- 这是「灵活性 vs 可预测性」的经典权衡
- 我现在倾向于认为：需要某种「软约束」——提供参考结构，但不强制

---

## 5. Phase 5：远程桥接

### 5.1 .docforge 中继协议

**做了什么**：建立本地与远程 AI 的协作机制，通过文件中继（而非 API 调用）。

```
本地 AI → outbox/*.md → 用户复制到外部 AI → 回答保存到 inbox/*.md → /ingest-remote 应用
```

**设计决策**：
- 文件中继而非 API 调用，因为：
  - 不需要管理 API Key
  - 用户可以审核发送的内容
  - 支持任何外部 AI（Claude、ChatGPT、Gemini...）

**现在的看法**：
- 这个设计是务实的，但用户体验有摩擦
- 手动复制粘贴很繁琐
- 适合「偶尔升级」的场景，不适合频繁使用
- 未来如果本地模型足够强，这个机制可能会边缘化

### 5.2 /escalate 和 /ingest-remote

**做了什么**：两个命令分别负责「打包上下文」和「应用外部建议」。

**现在的看法**：
- 这两个命令的存在感不强，我很少主动使用
- 更多时候是通过 `hardness-classify` 触发的「主动求助」

---

## 6. Phase 7：TODO 管理机制

### 6.1 todo-append Skill

**做了什么**：让 Commands 和 Skills 可以将代办事项写入 `docs/TODO.md`，而不是静默跳过。

**设计决策**：
- 全局 TODO 列表，作为项目的「记忆」
- 后续通过 `/do-todo` 命令批量处理

**现在的看法**：
- 这个机制很好，解决了「做一半忘了」的问题
- 但 TODO.md 的维护成本需要考虑
- 如果 TODO 积压太多，可能反而成为一种心理负担

---

## 7. 关键设计决策回顾

| 决策 | 选择 | 现在的看法 |
|------|------|-----------|
| AI 行为规则放在哪里 | 根目录 AGENTS.md | 对，但文件过长 |
| 文档类型系统 | 删除，改为 AI 自主判断 | 有代价，需要更好的引导机制 |
| Skill 拆分粒度 | 8 个功能型 Skill | 可能需要重新审视 |
| 远程桥接方式 | 文件中继 | 务实但繁琐 |
| 权限策略 | 保守（多问多确认） | 安全但对用户体验有影响 |

---

## 8. 小结

Phase 0-7 搭建了 MaeDoc 的骨架：

- **规则层**：AGENTS.md 定义 AI 行为边界
- **能力层**：8 个 Skills 提供写作能力
- **交互层**：`/create` 等命令作为用户入口
- **扩展层**：.docforge 支持远程增强
- **管理层**：TODO 机制追踪代办

这个架构是合理的，但在「AI 能力深化」这个方向上，我们还只是刚开始。接下来的问题是：**如何让本地模型更强？如何让协作更流畅？**

下一章，我们将深入反思四个核心设计的得失。

---

*本章最后更新：2026-02-21*
